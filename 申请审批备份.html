{extend name="base" /} {block name="body"}
    <style>
        .pop,#pop_one {
            display: none;
            width: 400px;
            min-height: 300px;
            max-height: 300px;
            height:300px;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            margin: auto;
            padding: 25px;
            z-index: 130;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 3px 18px rgba(100, 0, 0, .5);
        }
        .pop .pop-top,#pop_one .pop-top{
            height:40px;
            width:100%;
            border-bottom: 1px #E5E5E5 solid;
        }
        .pop .pop-top h2,#pop_one .pop-top h2{
            float: left;
            display:black
        }
        .pop .pop-top span,#pop_one .pop-top span{
            float: right;
            cursor: pointer;
            font-weight: bold;
            display:black
        }
        .pop .pop-foot,#pop_one .pop-foot{
            height:50px;
            line-height:50px;
            width:100%;
            border-top: 1px #E5E5E5 solid;
            text-align: right;
        }
        .pop .pop-cancel,.pop .pop-ok ,#pop_one .pop-cancel,#pop_one .pop-ok{
            padding:8px 15px;
            margin:15px 5px;
            border: none;
            border-radius: 5px;
            background-color: #337AB7;
            color: #fff;  cursor:pointer;
        }
        .pop .pop-cancel,#pop_one .pop-cancel{
            background-color: #FFF;
            border:1px #CECECE solid;
            color: #000;
        }
        .pop .pop-content,#pop_one .pop-content{
            height: 200px;
            text-align: center;
        }
        .pop .pop-content-left,#pop_one .pop-content-left{
            float: left;
        }
        .pop .pop-content-right,#pop_one .pop-content-right{
            width:310px;
            float: left;
            padding-top:20px;
            padding-left:20px;
            font-size: 16px;
            line-height:35px;
        }
        .pop .pop-content-right p,#pop_one .pop-content-right p{
            width:100%;
            height:45px;
            line-height: 45px;
        }
        .pop .pop-content-right p span,#pop_one .pop-content-right p span{
            display: inline-block;
            width:80px;
            text-align: right;
        }
        .pop .pop-content-right p select,#pop_one .pop-content-right p select{
            display: inline-block;
            width:220px;
            height: 30px;
        }
        .pop .pop-content-right p input,#pop_one .pop-content-right p input{
            display: inline-block;
            width:220px;
            height: 25px;
        }
        .pop .bgPop,#pop_one .bgPop{
            display: none;
            position: absolute;
            z-index: 129;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,.2);
        }
    </style>
    <form style="margin:15px auto" class="layui-form" action="">
        <div class="layui-form-item">
            <label class="layui-form-label">流程名</label>
            <div class="layui-input-block">
                <input style="width:600px;" type="text" name="title" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">审批说明</label>
            <div class="layui-input-block">
                <textarea style="width:1000px;" placeholder="请输入审批说明" class="layui-textarea"></textarea>
            </div>
        </div>
    </form>
    <fieldset class="layui-elem-field layui-field-title" style="margin: 20px 15px;">
        <legend>流程详情</legend>
    </fieldset>
    <div class="site-demo-button" id="layerDemo" style="margin: 20px 15px;">
        <button class="layui-btn click_pop">+添加审批</button>
    </div>

    <!--弹出层1-->
    <div class="pop">
        <div class="pop-top">
            <h2>添加审批人</h2>
            <span class="pop-close">Ｘ</span>
        </div>
        <div class="pop-content">
            <div class="pop-content-left">
                <img src="" alt="" class="teathumb">
            </div>
            <div class="pop-content-right">
                <p>
                    <span>科&nbsp;&nbsp;室:</span>
                    <select id="sel" name="">
                        <option value="妇产科">妇产科</option>
                        <option value="妇产科2">妇产科2</option>
                        <option value="妇产科3">妇产科3</option>
                    </select>
                </p>
                <p>
                    <span>审批人:</span>
                    <select id="sel_one" name="">
                        <option id="option" value="张三">张三1</option>
                        <option value="张三2">张三2</option>
                        <option value="张三3">张三3</option>
                    </select>
                </p>
                <p>
                    <span style="vertical-align: top">审批说明:</span>
                    <input id="test" type="text" placeholder="请输入说明文字">
                </p>
            </div>
        </div>
        <div class="pop-foot">
            <input onclick="se();" id="addTable" type="button" value="添加" class="pop-ok">
            <input type="button" value="关闭" class="pop-cancel pop-close">
        </div>
    </div>

    <!--弹出层2-->
    <div class="pop1" id="pop_one">
        <div class="pop-top">
            <h2>添加审批人</h2>
            <span class="pop-close">Ｘ</span>
        </div>
        <div class="pop-content">
            <div class="pop-content-left">
                <img src="" alt="" class="teathumb">
            </div>
            <div class="pop-content-right">
                <p>
                    <span>科&nbsp;&nbsp;室:</span>
                    <select id="sell" name="">
                        <option value="妇产科">妇产科</option>
                        <option value="妇产科2">妇产科2</option>
                        <option value="妇产科3">妇产科3</option>
                    </select>
                </p>
                <p>
                    <span>审批人:</span>
                    <select id="sell_one" name="">
                        <option value="张三">张三</option>
                        <option value="张三2">张三2</option>
                        <option value="张三3">张三3</option>
                    </select>
                </p>
                <p>
                    <span style="vertical-align: top">审批说明:</span>
                    <input id="testL" type="text" placeholder="请输入说明文字">
                </p>
            </div>
        </div>
        <div class="pop-foot">
            <input onclick="sell()" type="submit" value="更新" class="pop-ok">
            <input type="button" value="关闭" class="pop-cancel pop-close">
        </div>
    </div>

    <!--关联表格-->
    <form>
        <div class="layui-form" style="margin:10px 25px">
            <table class="layui-table" id="mytable">
                <colgroup>
                    <col width="100">
                    <col width="150">
                    <col width="250">
                    <col width="450">
                    <col>
                </colgroup>
                <thead>
                <tr>
                    <th>流程顺序</th>
                    <th>科室</th>
                    <th>审批人</th>
                    <th>流程说明</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody id="listTable">
                <tr>

                </tr>
                </tbody>
            </table>
        </div>
        <div class="layui-form-item" style="margin:15px 25px;">
            <button type="button" class="layui-btn" lay-submit="" lay-filter="demo2">立即提交</button>
        </div>
    </form>
    <script>
            // 模态框
            $(document).ready(function () {
                $('.pop-close').click(function () {
                    $('.bgPop,.pop').hide();
                });

                $('.click_pop').click(function () {
                    $('.bgPop,.pop').show();
                });

                $('.pop-close').click(function () {
                    $('.bgPop,.pop1').hide();
                });
            });

            // 表格删除一行
            // function delone(otr){
            //     var a=otr.parentNode.parentNode;
            //     a.parentNode.removeChild(a);
            //
            //
            //     // var msg = "确定要删除改行吗";
            //     // if (confirm(msg)==true){
            //     //     alert('删除成功！');
            //     //     return true;}
            //     //     return false;
            //
            // }
            function delRow(otr) {
                var targetTable = document.getElementById("mytable");
                var a=otr.parentNode.parentNode;
                  a.parentNode.removeChild(a);
            }
            // 同步模态框1表单表格数据
            var num =0;
            function se() {
                //num ++;
                var sel = document.getElementById("sel").value;
                var sel_one = document.getElementById("sel_one").value;
                var test = document.getElementById("test").value;
                var tr=document.createElement("tr");
                var td1=document.createElement("td");
                if(td1.innerHTML!=1){
                    // var num =0;
                    num ++;
                    td1.innerHTML=num;
                }else{
                    td1.innerHTML=num;
                    num++
                }
                var td2=document.createElement("td");
                var td3=document.createElement("td");
                var td4=document.createElement("td");
                var td5=document.createElement("td");
                td5.innerHTML="<a href='javascript:;' onclick='amend(this)' class=\"layui-btn layui-btn-xs click_pop_one\" lay-event=\"edit\">编辑</a><a href='javascript:;' onclick='delRow(this);'\n" +
                    "class=\"layui-btn layui-btn-danger layui-btn-xs\">删除</a>";
                // num ++;
                // td1.innerHTML=num;
                var str=sel;
                td2.innerHTML=str;
                var sttr=sel_one;
                td3.innerHTML=sttr;
                var sttrr=test;
                td4.innerHTML=sttrr;
                var tab=document.getElementById("mytable");
                tab.appendChild(tr);
                tr.appendChild(td1);
                tr.appendChild(td2);
                tr.appendChild(td3);
                tr.appendChild(td4);
                tr.appendChild(td5);

            }

            //表格编辑按钮关联弹出框2窗口相关的内容
            function modify(obj){
                var oTr = obj.parentNode.parentNode;
                var aTd = oTr.getElementsByTagName('td');
                rowIndex = obj.parentNode.parentNode.rowIndex;
                oNum.value = aTd[2].innerHTML;
                oUser.value = aTd[3].innerHTML;
                oPwd.value = aTd[4].innerHTML;
                //alert(i);
            }

            // 编辑当前行弹出的弹出框2里面的内容
            function amend(obj) {
                var oNum = document.getElementById('sell');
                var oUser = document.getElementById('sell_one');
                var oPwd = document.getElementById('testL');
                var oTr = obj.parentNode.parentNode;
                var aTd = oTr.getElementsByTagName('td');
                rowIndex = obj.parentNode.parentNode.rowIndex;
                oNum.value = aTd[1].innerHTML;
                oUser.value = aTd[2].innerHTML;
                oPwd.value = aTd[3].innerHTML;
                var pop_one=document.getElementById("pop_one");
                pop_one.style.display="block";

            }

            // 触发弹出框2按钮更新功能同步到表格当前行
            function sell() {
                var oNum = document.getElementById('sell');
                var oUser = document.getElementById('sell_one');
                var oPwd = document.getElementById('testL');
                var oMytable = document.getElementById('mytable');
                //alert(rowIndex);
                //var aTd = rowIndex.cells;
                console.log(oMytable.rows[rowIndex].cells);
                oMytable.rows[rowIndex].cells[1].innerHTML = oNum.value;
                oMytable.rows[rowIndex].cells[2].innerHTML = oUser.value;
                oMytable.rows[rowIndex].cells[3].innerHTML = oPwd.value;
                var pop_one=document.getElementById("pop_one");
                pop_one.style.display="none";
            }
    </script>



        {/block} {block name="js"}
        <script type="text/javascript" src="__ADMIN__/js/formadd.js"></script>
        {/block}